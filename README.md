# WebToon_Photoshop_Script


## 문제발생
기존에 psd별 범위를 나누는 데 사용하는 메소드가 마지막 excel img의 크기가 다르다는 특징을 이용해 사용했는데  
영어번역웹툰에서는 이 특징을 가지고 있지 않음. 


따라서 psd와 excel의 비율을 이용해 각 psd 범위를 나눌 생각

<br>


## Detail

#### [해결] Error 1 ) excel sheet 불러오기
Excel sheet 불러오는 방식을  ‘시트이름으로 불러오기’ >> ‘Active sheet를 불러오기’ 변경

<br>

#### [해결] Error 2 ) 각 psd에 해당하는 마지막 excel 이미지를 못 찾음
기존 웹툰 데이터와 영어팀 파트장님이 주신 웹툰의 psd파일 나누는 방식이 달라 엑셀을 해당하는 psd범위로 나누는 과정에서 기존의 방식 적용이 불가능함을 확인했습니다.

현재 이 부분에 대한 코드를 수정중에 있습니다.

아직 완성되지는 않았으나 현재는 아래의 아이디어로 더 범용성을 갖도록 문제를 해결하고자 합니다. 

1.	psd의 height를 이용하여 전체 psd에 대해서 각 psd파일의 시작점의 값을 구한다. 
2.	나온 값을 엑셀height단위로 환산하여 값을 구한다. (해당 위치를 excel 내에서 찾기 위함.)
3.	excel내에서 2번에서 구한 위치값에 해당하는 image와 이전 인덱스의 image까지의 image height를 실제 셀단위로 변경된 psd height와 크기비교를 한다.
4.	절대값을 구해서 차이가 적은 쪽의 이미지를 psd에 해당하는 마지막 excel이미지라고 판단하고 인덱스+1하여 psd시작이미지를 구해 범위를 지정한다.

<br>


### 추가문제발생
위의 내용을 진행하여 완성본을 만들었으나, 실제 사용해 본 결과 영어번역웹툰에는 이전 데이터들과 다른 특성이 있음을 알게되었음.
이전 데이터들에는 psd와 excel가 서로 관련있는 모양이었는데, 영어번역웹툰은 psd와 excel image의 spilt에 어떤 연관선도 없다.

<br>

이전에는 엑셀이미지들은 하나의 psd이미지가 여러개로 잘린 형태로 구성되어있었는데 영어웹툰은 psd가 나뉘는 부분에서 img가 잘리지 않는다. (연관성없음.)
따라서 psd2excel 비율로 변환한 지점과 가까운 이미지 index로 대사를 읽어 저장하는 것은 불가능하게 된다.
정확도를 높이기 위해 index를 사용한 것인데 이게 문제가 되고 있는 상황
psd2excel이 아니라 psd2cell 비율을 사용해야 할 거 같은데 그간 시도했던 바에 따르면 이거 불가능함.





